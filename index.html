<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EasyCalc</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    padding: 20px;
    background: #121212;
    color: white;
  }
  .calculator {
    margin: 20px auto;
    padding: 20px;
    border-radius: 10px;
    background: #1e1e1e;
    max-width: 400px;
  }
  .buttons button {
    width: 60px;
    height: 45px;
    margin: 5px;
    border: none;
    border-radius: 8px;
    background: #2a2a2a;
    color: white;
    font-size: 16px;
    cursor: pointer;
  }
  .buttons button:hover { background: #3a3a3a; }
  .ad-container {
    background: #2c2c2c;
    color: #ccc;
    padding: 10px;
    margin: 20px auto;
    text-align: center;
    border-radius: 8px;
    max-width: 728px;
  }
</style>
</head>

<body>
<h2>EasyCalc</h2>
<button class="theme-toggle" onclick="toggleTheme()">Light Mode</button>

<!-- Ad Slot 1 (Top Banner) -->
<div class="ad-container" id="top-ad">
  Ad Space: Top Banner (728x90) - Integrate for earnings
</div>

<div class="calculator">
  <div id="history"></div>
  <input type="text" id="display" readonly>
  <button class="mode-toggle" onclick="toggleMode()">Mode: Degrees</button>
  <div class="buttons">
    <button class="clear" onclick="clearDisplay()">C</button>
    <button onclick="appendToDisplay('(')">(</button>
    <button onclick="appendToDisplay(')')">)</button>
    <button onclick="backspace()">⌫</button>
    <button class="scientific" onclick="calculateFunction('sqrt')">√</button>
    <button onclick="appendToDisplay('7')">7</button>
    <button onclick="appendToDisplay('8')">8</button>
    <button onclick="appendToDisplay('9')">9</button>
    <button class="operator" onclick="appendToDisplay('/')">/</button>
    <button class="scientific" onclick="calculateFunction('sin')">sin</button>
    <button onclick="appendToDisplay('4')">4</button>
    <button onclick="appendToDisplay('5')">5</button>
    <button onclick="appendToDisplay('6')">6</button>
    <button class="operator" onclick="appendToDisplay('*')">*</button>
    <button class="scientific" onclick="calculateFunction('cos')">cos</button>
    <button onclick="appendToDisplay('1')">1</button>
    <button onclick="appendToDisplay('2')">2</button>
    <button onclick="appendToDisplay('3')">3</button>
    <button class="operator" onclick="appendToDisplay('-')">-</button>
    <button class="scientific" onclick="calculateFunction('tan')">tan</button>
    <button onclick="appendToDisplay('0')">0</button>
    <button onclick="appendToDisplay('.')">.</button>
    <button class="scientific" onclick="calculateFunction('log')">log</button>
    <button class="operator" onclick="appendToDisplay('+')">+</button>
    <button class="scientific" onclick="calculateFunction('ln')">ln</button>
    <button class="scientific" onclick="calculateFunction('pow')">x^y</button>
    <button class="scientific" onclick="calculateFunction('fact')">!</button>
    <button class="scientific" onclick="calculateFunction('inv')">1/x</button>
    <button class="scientific" onclick="appendConstant('pi')">π</button>
    <button class="scientific" onclick="appendConstant('e')">e</button>
    <button class="equal" onclick="calculate()">=</button>
  </div>
</div>

<!-- Ad Slot 2 -->
<div class="ad-container" id="ad-slot-2">
  Ad Space: Below Calculator (Responsive)
</div>

<!-- Ad Slot 3 -->
<div class="ad-container" id="ad-slot-3">
  Ad Space: Below Ad 2 (Responsive)
</div>

<!-- Ad Slot 4 -->
<div class="ad-container" id="ad-slot-4">
  Ad Space: Bottom Banner (728x90)
</div>

<script>
const display = document.getElementById('display');
const history = document.getElementById('history');
let isDegrees = true;
let lastWasEqual = false;

// Safe evaluator instead of eval()
function safeEval(expr) {
  if (/[^0-9+\-*/().^ ]/.test(expr)) throw new Error("Invalid");
  return Function('"use strict";return (' + expr.replace(/\^/g, '**') + ')')();
}

function toggleMode() {
  isDegrees = !isDegrees;
  document.querySelector('.mode-toggle').textContent =
    `Mode: ${isDegrees ? 'Degrees' : 'Radians'}`;
}

function appendToDisplay(value) {
  if (lastWasEqual) {
    display.value = '';
    lastWasEqual = false;
  }
  display.value += value;
}

function appendConstant(constant) {
  if (lastWasEqual) {
    display.value = '';
    lastWasEqual = false;
  }
  const values = { pi: Math.PI, e: Math.E };
  display.value += values[constant];
}

function clearDisplay() {
  display.value = '';
  history.textContent = '';
  lastWasEqual = false;
}

function backspace() {
  display.value = display.value.slice(0, -1);
}

function factorial(n) {
  if (n < 0) return 'Error';
  if (n === 0 || n === 1) return 1;
  return n * factorial(n - 1);
}

function calculateFunction(func) {
  if (lastWasEqual) {
    display.value = '';
    lastWasEqual = false;
  }
  const value = parseFloat(display.value);
  if (isNaN(value)) return;
  let result;
  switch (func) {
    case 'sqrt': result = Math.sqrt(value); break;
    case 'sin': result = isDegrees ? Math.sin(value * Math.PI / 180) : Math.sin(value); break;
    case 'cos': result = isDegrees ? Math.cos(value * Math.PI / 180) : Math.cos(value); break;
    case 'tan': result = isDegrees ? Math.tan(value * Math.PI / 180) : Math.tan(value); break;
    case 'log': result = Math.log10(value); break;
    case 'ln': result = Math.log(value); break;
    case 'pow': result = Math.pow(value, 2); break;
    case 'fact': result = factorial(value); break;
    case 'inv': result = 1 / value; break;
  }
  if (result !== undefined) {
    history.textContent = `${func}(${value}) = ${result}`;
    display.value = result;
  }
}

function calculate() {
  try {
    const result = safeEval(display.value);
    if (isNaN(result) || !isFinite(result)) throw new Error();
    history.textContent = `${display.value} = ${result}`;
    display.value = result;
    lastWasEqual = true;
  } catch {
    display.value = 'Error';
    history.textContent = '';
    lastWasEqual = false;
  }
}

document.addEventListener('keydown', (e) => {
  if (e.key >= '0' && e.key <= '9') appendToDisplay(e.key);
  else if (['.', '+', '-', '*', '/'].includes(e.key)) appendToDisplay(e.key);
  else if (e.key === 'Enter') calculate();
  else if (e.key === 'Backspace') backspace();
  else if (e.key.toLowerCase() === 'c') clearDisplay();
});

// Theme toggle
const body = document.body;
const themeBtn = document.querySelector('.theme-toggle');
const savedTheme = localStorage.getItem('theme') || 'dark';
body.dataset.theme = savedTheme;
themeBtn.textContent = savedTheme === 'light' ? 'Dark Mode' : 'Light Mode';

function toggleTheme() {
  const current = body.dataset.theme;
  const newTheme = current === 'dark' ? 'light' : 'dark';
  body.dataset.theme = newTheme;
  themeBtn.textContent = newTheme === 'light' ? 'Dark Mode' : 'Light Mode';
  localStorage.setItem('theme', newTheme);
}
</script>
</body>
</html>
